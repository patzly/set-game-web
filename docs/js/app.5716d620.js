(function(){"use strict";var e={6722:function(e,t,o){var n=o(5130),s=o(6768);const a={id:"app"},r={class:"main"};function l(e,t,o,n,l,i){const c=(0,s.g2)("menu-component"),d=(0,s.g2)("home-component"),u=(0,s.g2)("settings-component"),h=(0,s.g2)("cards-component"),m=(0,s.g2)("bottom-component"),f=(0,s.g2)("offline-component");return(0,s.uX)(),(0,s.CE)("div",a,[l.home?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)(c,{key:0,offlineMode:l.home,"can-undo":l.canUndo,"can-redo":l.canRedo,gameState:l.gameState,gameId:l.gameId},null,8,["offlineMode","can-undo","can-redo","gameState","gameId"])),(0,s.Lk)("div",r,[l.home?((0,s.uX)(),(0,s.Wv)(d,{key:0,offlineMode:l.home,onUpdateWebSocket:i.setWebSocket,onLocalCreateGame:i.handleLocalCreateGame,onLocalJoinGame:i.handleLocalJoinGame},null,8,["offlineMode","onUpdateWebSocket","onLocalCreateGame","onLocalJoinGame"])):(0,s.Q3)("",!0),l.gameState||l.home?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)(u,{key:1,offlineMode:l.home,playerCount:l.playerCount,easyMode:l.easyMode,"onUpdate:playerCount":t[0]||(t[0]=e=>l.playerCount=e)},null,8,["offlineMode","playerCount","easyMode"])),l.gameState?((0,s.uX)(),(0,s.Wv)(h,{key:2,offlineMode:l.home,cards:l.cards,selectedPlayer:l.selectedPlayer},null,8,["offlineMode","cards","selectedPlayer"])):(0,s.Q3)("",!0)]),(0,s.bF)(m,{gameState:l.gameState,playerCount:l.playerCount,selectedPlayer:l.selectedPlayer,players:l.players,message:l.message,home:l.home,onEndSession:i.handleEndSession,onSelectPlayer:i.handlePlayerSelection},null,8,["gameState","playerCount","selectedPlayer","players","message","home","onEndSession","onSelectPlayer"]),l.isOnline||l.home?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)(f,{key:1,disableOfflineMode:i.disableOfflineMode},null,8,["disableOfflineMode"]))])}o(8992),o(2577),o(1454);var i=o(4232);const c={class:"menu"},d={class:"game-id"},u=["value"];function h(e,t,o,a,r,l){return(0,s.uX)(),(0,s.CE)("div",c,[(0,s.Lk)("a",{href:"#",class:(0,i.C4)(["undo",{disabled:!o.canUndo}]),onClick:t[0]||(t[0]=(0,n.D$)((e=>l.triggerAction("undo")),["prevent"]))},"UNDO",2),(0,s.Lk)("a",{href:"#",class:(0,i.C4)(["redo",{disabled:!o.canRedo}]),onClick:t[1]||(t[1]=(0,n.D$)((e=>l.triggerAction("redo")),["prevent"]))},"REDO",2),o.gameState?((0,s.uX)(),(0,s.CE)("a",{key:0,href:"#",class:"add-cards",onClick:t[2]||(t[2]=(0,n.D$)((e=>l.triggerAction("addColumn")),["prevent"]))},"ADD CARDS")):(0,s.Q3)("",!0),o.gameState?((0,s.uX)(),(0,s.CE)("a",{key:1,href:"#",class:"exit",onClick:t[3]||(t[3]=(0,n.D$)((e=>l.triggerAction("exit")),["prevent"]))},"EXIT")):(0,s.Q3)("",!0),(0,s.Lk)("div",d,[t[5]||(t[5]=(0,s.Lk)("label",{for:"gameIdInput"},"Game ID:",-1)),(0,s.Lk)("input",{id:"gameIdInput",type:"text",value:o.gameId,readonly:"",onClick:t[4]||(t[4]=(...e)=>l.copyGameId&&l.copyGameId(...e)),title:"Klicken, um die Game-ID zu kopieren"},null,8,u)])])}let m=null;function f(e){return m||(m=new WebSocket(e),m.onopen=()=>{console.log("WebSocket connected"),m.send(JSON.stringify({action:"getSettings"}))},m.onerror=e=>console.error("WebSocket error:",e)),m}function g(){if(!m)throw new Error("WebSocket is not initialized. Call initializeWebSocket first.");return m}var p={name:"menu-component",props:{canUndo:Boolean,canRedo:Boolean,gameState:Boolean,gameId:String},methods:{triggerAction(e){const t=g();t.send(JSON.stringify({action:e}))},copyGameId(){navigator.clipboard.writeText(this.gameId).then((()=>{})).catch((e=>{console.error("Fehler beim Kopieren der Game-ID:",e)}))}}},k=o(1241);const y=(0,k.A)(p,[["render",h]]);var b=y;const v={class:"settings"},S={class:"row"},C={class:"value"},w={class:"row"},E={class:"value"},O={class:"start"};function I(e,t,o,a,r,l){return(0,s.uX)(),(0,s.CE)("div",v,[(0,s.Lk)("div",S,[t[4]||(t[4]=(0,s.Lk)("div",{class:"label"},"PLAYERS",-1)),(0,s.Lk)("div",C,[(0,s.Lk)("a",{href:"#",class:(0,i.C4)(["button-left",{disabled:o.playerCount<=1}]),onClick:t[0]||(t[0]=(0,n.D$)(((...e)=>l.removePlayer&&l.removePlayer(...e)),["prevent"]))},"<",2),(0,s.eW)(" "+(0,i.v_)(o.playerCount)+" ",1),(0,s.Lk)("a",{href:"#",class:(0,i.C4)(["button-right",{disabled:o.playerCount>=10}]),onClick:t[1]||(t[1]=(0,n.D$)(((...e)=>l.addPlayer&&l.addPlayer(...e)),["prevent"]))},">",2)])]),(0,s.Lk)("div",w,[t[5]||(t[5]=(0,s.Lk)("div",{class:"label"},"EASY MODE",-1)),(0,s.Lk)("div",E,[(0,s.Lk)("a",{href:"#",class:"highlight",onClick:t[2]||(t[2]=(0,n.D$)(((...e)=>l.toggleEasyMode&&l.toggleEasyMode(...e)),["prevent"]))},(0,i.v_)(o.easyMode?"ON":"OFF"),1)])]),(0,s.Lk)("div",O,[(0,s.Lk)("a",{href:"#",class:"start-button",onClick:t[3]||(t[3]=(0,n.D$)((e=>l.startGame()),["prevent"]))},"START GAME")])])}var L={name:"settings-component",props:{playerCount:Number,easyMode:Boolean,offlineMode:Boolean},methods:{addPlayer(){const e=g();e.readyState===WebSocket.OPEN?e.send(JSON.stringify({action:"addPlayer"})):console.warn("WebSocket offline: Spieleranzahl wird nur lokal aktualisiert.")},removePlayer(){const e=g();e.readyState===WebSocket.OPEN?e.send(JSON.stringify({action:"removePlayer"})):console.warn("WebSocket offline: Spieleranzahl wird nur lokal aktualisiert.")},toggleEasyMode(){const e=g();e.readyState===WebSocket.OPEN?e.send(JSON.stringify({action:"switchEasy"})):console.warn("WebSocket offline: Easy Mode kann nicht geÃ¤ndert werden.")},startGame(){const e=g();e.readyState===WebSocket.OPEN?e.send(JSON.stringify({action:"startGame"})):console.error("WebSocket offline: Das Spiel kann nicht gestartet werden.")}}};const P=(0,k.A)(L,[["render",I],["__scopeId","data-v-d808e9be"]]);var G=P;const M={class:"cards"},W=["id","checked","disabled","onChange"];function A(e,t,o,n,a,r){return(0,s.uX)(),(0,s.CE)("div",M,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(a.localCards,((e,t)=>((0,s.uX)(),(0,s.CE)("div",{key:t,class:"card-container"},[(0,s.Lk)("canvas",{class:(0,i.C4)({card:!0,selected:e.selected??!1}),ref_for:!0,ref:"cardCanvas-"+t},null,2),(0,s.Lk)("input",{type:"checkbox",id:"card-"+t,class:"card-checkbox",checked:e.selected,disabled:!r.isPlayerSelected,onChange:e=>r.handleCheckboxChange(t)},null,40,W)])))),128))])}o(4114),o(3949);function D(e,t){const o=document.createElement("canvas"),n=o.getContext("2d");o.width=2*t,o.height=2*t,n.fillStyle=e,n.fillRect(0,0,o.width,t);const s=document.createElement("canvas"),a=s.getContext("2d");return a.createPattern(o,"repeat")}var N={name:"cards-component",props:{cards:{type:Array,default:()=>[]},selectedIndices:{type:Array,default:()=>[]},selectedPlayer:{type:Object,default:()=>null}},data(){return{localCards:[...this.cards],sessionSelectedIndices:[...this.selectedIndices]}},methods:{renderCard(e){const t=this.$refs[`cardCanvas-${e}`];if(Array.isArray(t)&&"CANVAS"===t[0]?.tagName){const o=t[0],n=this.localCards[e];console.log(n,e);const s=o.getContext("2d");if(s){let e;s.clearRect(0,0,o.width,o.height),"RED"===n.color?e="#da0100":"GREEN"===n.color?e="#ffa800":"BLUE"===n.color&&(e="#060488"),s.strokeStyle=e,s.lineWidth=5,"SOLID"===n.shading?s.fillStyle=e:"STRIPED"===n.shading?s.fillStyle=D(e,5):"OUTLINED"===n.shading?s.fillStyle="white":s.fillStyle=e;const t=10,a=o.width-2*t,r=o.height-2*t,l=a/5,i=r/2;let c;if(1===n.number)c=[a/2+t];else if(2===n.number){const e="SQUIGGLE"!==n.symbol?a/4:a/3,o=(e-l)/2-("SQUIGGLE"!==n.symbol?0:45);c=[e+l/2+t+o,2*e+l/2+t+o]}else if(3===n.number){const e="SQUIGGLE"!==n.symbol?a/4:a/3,o="SQUIGGLE"!==n.symbol?0:-45;c=[e+t+o,2*e+t+o,3*e+t+o]}if("OVAL"===n.symbol)for(let o=0;o<c.length;o++)s.roundRect(c[o]-l/2,r/2+t-i/2,l,i,l/2),s.fill(),s.stroke();else if("DIAMOND"===n.symbol)for(let o=0;o<c.length;o++){const e=c[o],n=r/2+t-i/2;s.beginPath(),s.moveTo(e,n),s.lineTo(e-l/2,n+i/2),s.lineTo(e,n+i),s.lineTo(e+l/2,n+i/2),s.closePath(),s.fill(),s.stroke()}else if("SQUIGGLE"===n.symbol)for(let o=0;o<c.length;o++){const e=c[o],n=r/2+t-i/2;s.save();const a=.65;s.scale(a,a),s.translate(e+100,n+120),s.rotate(Math.PI/2),s.beginPath(),s.moveTo(0,0),s.bezierCurveTo(8.4,21.9,-14.3,45.8,-41,39),s.bezierCurveTo(-51.7,36.3,-61.8,27,-77,38),s.bezierCurveTo(-94.4,50.6,-98.6,43.3,-99,25),s.bezierCurveTo(-99.4,7,-84.9,-5.3,-68,-3),s.bezierCurveTo(-44.8,-.8,-42.1,16.5,-15,-1),s.bezierCurveTo(-8.7,-5,-3.1,-8.1,0,0),s.closePath(),s.restore(),s.fill(),s.stroke()}}else console.warn(`Canvas context for ID ${e} could not be retrieved.`)}else console.warn(`Canvas with ID ${e} is not valid or not found.`)},handleCheckboxChange(e){if(!this.selectedPlayer)return;const t=this.sessionSelectedIndices.indexOf(e);t>-1?this.sessionSelectedIndices.splice(t,1):this.sessionSelectedIndices.push(e),this.localCards[e].selected=!this.localCards[e].selected,3===this.sessionSelectedIndices.length&&(this.selectCards(this.sessionSelectedIndices),this.resetSelection())},selectCards(e){const t=g(),o=e.map((e=>{const t=String.fromCharCode(97+Math.floor(e/3)),o=e%3+1;return`${t}${o}`}));t.send(JSON.stringify({action:"selectCards",coordinates:o.join("-")})),console.log("Selected card coordinates:",o)},resetSelection(){this.sessionSelectedIndices=[],this.localCards.forEach((e=>e.selected=!1))}},computed:{isPlayerSelected(){return null!==this.selectedPlayer}},watch:{cards:{immediate:!0,handler(e){this.localCards=[...e],this.$nextTick((()=>{this.localCards.forEach(((e,t)=>{this.renderCard(t)}))}))}}}};const T=(0,k.A)(N,[["render",A],["__scopeId","data-v-31a31ded"]]);var $=T;const X={class:"bottom"},U={key:0,class:"rules"},x={key:1,class:"end-session"},R={key:2,class:"player-selection"},J=["onClick"],j={key:3,class:"message"};function Q(e,t,o,a,r,l){return(0,s.uX)(),(0,s.CE)("div",X,[o.home?((0,s.uX)(),(0,s.CE)("div",U,t[1]||(t[1]=[(0,s.Lk)("a",{href:"/rules"},"GAME RULES",-1)]))):(0,s.Q3)("",!0),o.gameState||o.home?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",x,[(0,s.Lk)("a",{href:"#",onClick:t[0]||(t[0]=(0,n.D$)((e=>l.endSession()),["prevent"]))},"END SESSION")])),o.gameState?((0,s.uX)(),(0,s.CE)("div",R,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(o.players,(e=>((0,s.uX)(),(0,s.CE)("div",{key:e.number},[(0,s.Lk)("a",{href:"#",class:(0,i.C4)({selected:o.selectedPlayer&&o.selectedPlayer.number===e.number}),onClick:(0,n.D$)((t=>l.selectPlayer(e)),["prevent"])}," PLAYER "+(0,i.v_)(e.number)+": "+(0,i.v_)(e.sets.length),11,J)])))),128))])):(0,s.Q3)("",!0),o.gameState?((0,s.uX)(),(0,s.CE)("div",j,(0,i.v_)(o.message),1)):(0,s.Q3)("",!0)])}var _={name:"bottom-component",props:{gameState:{type:Boolean,required:!0},playerCount:{type:Number,required:!0},selectedPlayer:{type:Object,default:()=>null},players:{type:Array,required:!0},message:{type:String,required:!0},home:{type:Boolean,required:!0}},methods:{selectPlayer(e){this.$emit("select-player",e)},endSession(){this.$emit("end-session")}}};const B=(0,k.A)(_,[["render",Q],["__scopeId","data-v-3f756ba4"]]);var z=B;const F={class:"offline-container"};function q(e,t,o,n,a,r){return(0,s.uX)(),(0,s.CE)("div",F,[t[1]||(t[1]=(0,s.Lk)("div",{class:"offline-message"},[(0,s.Lk)("p",null,"Du bist offline! Versuche, die Verbindung wiederherzustellen.")],-1)),t[2]||(t[2]=(0,s.Lk)("div",{class:"offline-animation"},null,-1)),(0,s.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>r.goBackToHome&&r.goBackToHome(...e)),class:"back-to-home-btn"},"ZurÃ¼ck zum Home")])}var H={props:{disableOfflineMode:Function},data(){return{isOnline:navigator.onLine}},created(){},unmounted(){},methods:{handleOnline(){this.isOnline=!0},handleOffline(){this.isOnline=!1},goBackToHome(){this.disableOfflineMode()}}};const V=(0,k.A)(H,[["render",q],["__scopeId","data-v-0c6f51a4"]]);var K=V;class Y{constructor(e,t,o,n,s,a){this.number=e,this.color=t,this.shading=o,this.symbol=n,this.selected=s,this.name=a}}const Z={class:"game-options"},ee={class:"row"},te={class:"join-game-wrapper"};function oe(e,t,o,a,r,l){return(0,s.uX)(),(0,s.CE)("div",Z,[(0,s.Lk)("div",ee,[(0,s.Lk)("a",{href:"#",class:"button create-game",onClick:t[0]||(t[0]=(0,n.D$)(((...e)=>l.createGame&&l.createGame(...e)),["prevent"]))},"CREATE GAME"),(0,s.Lk)("div",te,[(0,s.bo)((0,s.Lk)("input",{type:"text",class:"game-id-input","onUpdate:modelValue":t[1]||(t[1]=e=>r.gameId=e),placeholder:"Enter Game ID"},null,512),[[n.Jo,r.gameId]]),(0,s.Lk)("a",{href:"#",class:"button join-game",onClick:t[2]||(t[2]=(0,n.D$)(((...e)=>l.joinGame&&l.joinGame(...e)),["prevent"]))},"JOIN GAME")])])])}var ne={name:"home-component",props:{offlineMode:Boolean},data(){return{gameId:""}},methods:{createGame(){const e=this.generateUniqueId();this.$emit("localCreateGame",e)},joinGame(){this.gameId?this.$emit("localJoinGame",this.gameId):console.warn("Game ID is required to join a game.")},generateUniqueId(){return Math.random().toString(36).substr(2,9)}}};const se=(0,k.A)(ne,[["render",oe]]);var ae=se,re={name:"MainComponent",components:{MenuComponent:b,HomeComponent:ae,SettingsComponent:G,CardsComponent:$,BottomComponent:z,OfflineComponent:K},data(){return{websocket:null,canUndo:!1,canRedo:!1,gameState:!1,playerCount:1,easyMode:!1,cards:[],selectedCardIndices:[],selectedPlayer:null,players:[],message:"",isOnline:navigator.onLine,home:!0,websocketTimeout:null,loading:!1,gameId:""}},methods:{setWebSocket(e){this.loading=!0,this.isOnline=!0,null!=this.websocket&&this.websocket.open&&this.websocket.close(),this.websocket=f(`ws://localhost:9000/socket/${e}`),this.gameId=e,console.log("WebSocket updated in MainComponent:",this.websocket),this.websocketTimeout=setTimeout((()=>{this.websocket&&this.websocket.readyState===WebSocket.OPEN||(this.isOnline=!1,console.log("WebSocket konnte nicht innerhalb von 5 Sekunden verbunden werden. Offline-Modus aktiviert."),this.loading=!1)}),100),this.setupWebSocketHandlers()},disableOfflineMode(){this.home=!0,this.isOnline=!0,location.reload()},setupWebSocketHandlers(){this.websocket&&(this.websocket.onopen=()=>{this.websocketTimeout&&(clearTimeout(this.websocketTimeout),this.websocketTimeout=null),this.isOnline=!0,this.websocket.send(JSON.stringify({action:"getState"})),this.loading=!1,console.log("WebSocket-Verbindung erfolgreich.")},this.websocket.onmessage=e=>{const t=JSON.parse(e.data);console.log("WebSocket message:",t),this.canUndo=t.canUndo??this.canUndo,this.canRedo=t.canRedo??this.canRedo,this.gameState=t.inGame??this.gameState,this.easyMode=t.easy??this.easyMode,this.playerCount=t.playercount??this.playerCount,this.selectedPlayer=null!==t.selectedPlayer?this.players.find((e=>e.number===t.selectedPlayer)):null,this.message=t.message??this.message,t.cards&&(this.cards=t.cards.map((e=>new Y(e.number,e.color,e.shading,e.symbol,e.selected,e.name)))),t.players&&(this.players=t.players)},this.websocket.onclose=()=>{console.warn("WebSocket closed. Game may be disconnected."),this.websocket=null,this.isOnline=!0,this.loading=!1})},handleLocalCreateGame(e){console.log(`Local game created with ID: ${e}`),this.home=!1,this.setWebSocket(e)},handleLocalJoinGame(e){console.log("Joined game locally."),this.home=!1,this.setWebSocket(e)},handleEndSession(){this.websocket.close(),this.websocket=null,this.home=!0,location.reload()},handlePlayerSelection(e){this.websocket&&this.websocket.send(JSON.stringify({action:"selectPlayer",playerNumber:e.number})),this.selectedPlayer=e}}};const le=(0,k.A)(re,[["render",l]]);var ie=le,ce=o(4458);(0,ce.k)("/service-worker.js",{ready(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered(){console.log("Service worker has been registered.")},cached(){console.log("Content has been cached for offline use.")},updatefound(){console.log("New content is downloading.")},updated(){console.log("New content is available; please refresh.")},offline(){console.log("No internet connection found. App is running in offline mode.")},error(e){console.error("Error during service worker registration:",e)}}),"serviceWorker"in navigator&&window.addEventListener("load",(()=>{navigator.serviceWorker.register("/service-worker.js").then((e=>{console.log("Service Worker registered with scope:",e.scope)})).catch((e=>{console.log("Service Worker registration failed:",e)}))})),(0,n.Ef)(ie).mount("#app")}},t={};function o(n){var s=t[n];if(void 0!==s)return s.exports;var a=t[n]={exports:{}};return e[n].call(a.exports,a,a.exports,o),a.exports}o.m=e,function(){var e=[];o.O=function(t,n,s,a){if(!n){var r=1/0;for(d=0;d<e.length;d++){n=e[d][0],s=e[d][1],a=e[d][2];for(var l=!0,i=0;i<n.length;i++)(!1&a||r>=a)&&Object.keys(o.O).every((function(e){return o.O[e](n[i])}))?n.splice(i--,1):(l=!1,a<r&&(r=a));if(l){e.splice(d--,1);var c=s();void 0!==c&&(t=c)}}return t}a=a||0;for(var d=e.length;d>0&&e[d-1][2]>a;d--)e[d]=e[d-1];e[d]=[n,s,a]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={524:0};o.O.j=function(t){return 0===e[t]};var t=function(t,n){var s,a,r=n[0],l=n[1],i=n[2],c=0;if(r.some((function(t){return 0!==e[t]}))){for(s in l)o.o(l,s)&&(o.m[s]=l[s]);if(i)var d=i(o)}for(t&&t(n);c<r.length;c++)a=r[c],o.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return o.O(d)},n=self["webpackChunksetapp"]=self["webpackChunksetapp"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=o.O(void 0,[504],(function(){return o(6722)}));n=o.O(n)})();
//# sourceMappingURL=app.5716d620.js.map